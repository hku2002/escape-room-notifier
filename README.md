# 방탈출 예약 알림 서비스 기획서

## 📋 프로젝트 개요

### 프로젝트 목적

방탈출 카페의 인기 테마 예약이 어려운 사용자들을 위해, 원하는 테마의 빈 시간이 생기면 즉시 알림을 받을 수 있는 서비스를 제공합니다.

### 핵심 가치

- ⏰ **실시간 모니터링**: 지속적으로 예약 현황을 확인하여 빈 시간 발견
- 🔔 **즉시 알림**: 설정한 테마에 빈 시간이 생기면 실시간 알림
- 🎯 **맞춤 설정**: 원하는 테마, 날짜, 시간대를 자유롭게 설정

---

## 🎯 주요 기능

### 1. 크롤링 시스템

**설명**: 주요 방탈출 예약 사이트에서 예약 가능 시간 정보를 수집

**대상 사이트**

- 방탈출 전문 플랫폼 (예: 방방, 프리즘, 비트포비아 등)
- 개별 방탈출 카페 자체 예약 시스템

**수집 정보**

- 테마명
- 날짜
- 시간대
- 예약 가능 여부
- 가격 정보
- 지점/위치 정보

**크롤링 주기**

- 기본: 5-30분 간격
- 사용자 설정에 따라 조정 가능

### 2. 사용자 설정 관리

**테마 관심 등록**

- 관심 테마 추가/삭제
- 우선순위 설정
- 복수 테마 등록 가능

**알림 조건 설정**

- 원하는 날짜 범위 (예: 2025-12-01 ~ 2025-12-31)
- 원하는 시간대 (예: 평일 저녁, 주말 오후)
- 인원 수
- 특정 지점 선택

**알림 방식 선택**

- 이메일
- 카카오톡 알림
- 웹 푸시 알림
- 문자 메시지 (선택사항)

### 3. 알림 시스템

**알림 발송 조건**

- 설정한 테마의 빈 시간 발견 시
- 사용자가 설정한 조건(날짜, 시간대) 일치 시
- 중복 알림 방지 (동일 시간대 재알림 차단)

**알림 내용**

- 테마명
- 카페명/지점
- 예약 가능 날짜 및 시간
- 예약 페이지 바로가기 링크
- 가격 정보

### 4. 대시보드

**모니터링 현황**

- 현재 추적 중인 테마 목록
- 최근 알림 히스토리
- 테마별 예약 가능률 통계

**빠른 예약 링크**

- 각 테마별 예약 페이지 직접 연결
- 자주 찾는 테마 즐겨찾기

---

## 🏗️ 시스템 아키텍처

### 기술 스택 (권장)

**Backend**

- Java 17 + Spring Boot
- Spring WebFlux (비동기/반응형 처리)
- Scheduler (크롤링 작업 스케줄링)
- WebClient (HTTP 크롤링)

**Database**

- MariaDB / MySQL (관계형 데이터)
- Redis (크롤링 결과 캐싱, 중복 알림 방지)

**크롤링**

- Selenium / Playwright (동적 웹페이지 크롤링)
- Jsoup (정적 HTML 파싱)

**알림**

- Firebase Cloud Messaging (푸시 알림)
- SMTP (이메일)
- 카카오톡 비즈니스 API

**Infra**

- Docker / Docker Compose
- AWS EC2 or 클라우드 서버

### 시스템 구성도

```
[크롤러] → [데이터 수집] → [DB 저장]
                              ↓
                        [비교 엔진]
                              ↓
                      [조건 매칭 확인]
                              ↓
                        [알림 발송]

```

---

## 📊 데이터베이스 설계

### 주요 테이블

**users (사용자)**

- user_id (PK)
- email
- password (암호화)
- notification_settings (알림 방식 설정)
- created_at
- updated_at

**themes (테마 정보)**

- theme_id (PK)
- cafe_name (카페명)
- theme_name (테마명)
- branch (지점)
- difficulty (난이도)
- genre (장르)
- duration (소요시간)
- price (가격)

**user_alerts (사용자 알림 설정)**

- alert_id (PK)
- user_id (FK)
- theme_id (FK)
- date_start (시작 날짜)
- date_end (종료 날짜)
- preferred_times (선호 시간대: JSON)
- num_people (인원 수)
- is_active (활성화 여부)
- created_at

**availability (예약 가능 현황)**

- availability_id (PK)
- theme_id (FK)
- date (날짜)
- time_slot (시간대)
- is_available (예약 가능 여부)
- crawled_at (크롤링 시간)

**notifications (알림 히스토리)**

- notification_id (PK)
- user_id (FK)
- alert_id (FK)
- availability_id (FK)
- sent_at (발송 시간)
- notification_type (알림 타입)
- status (발송 성공/실패)

---

## 🔄 주요 프로세스

### 1. 크롤링 프로세스

```
1. 스케줄러 시작 (5분마다)
2. 대상 사이트 목록 조회
3. 각 사이트별 크롤링 실행
   - 테마 정보 수집
   - 예약 가능 시간 수집
4. 이전 데이터와 비교
5. 변경사항 DB 저장
6. 새로운 빈 시간 발견 시 알림 트리거

```

### 2. 알림 발송 프로세스

```
1. 새로운 빈 시간 감지
2. 해당 테마를 구독하는 사용자 조회
3. 각 사용자의 알림 조건 확인
   - 날짜 범위 일치
   - 시간대 일치
   - 인원 수 일치
4. 조건 일치 시 알림 발송
5. 알림 히스토리 기록
6. 중복 알림 방지 플래그 설정

```

### 3. 사용자 등록 프로세스

```
1. 회원가입 (이메일 인증)
2. 로그인
3. 관심 테마 검색 및 선택
4. 알림 조건 설정
5. 알림 방식 선택
6. 모니터링 시작

```

---

## 🎨 UI/UX 요구사항

### 주요 화면

**1. 메인 대시보드**

- 내가 추적 중인 테마 카드 리스트
- 실시간 알림 현황
- 빠른 설정 버튼

**2. 테마 검색/선택**

- 키워드 검색
- 카페별 필터링
- 지역별 필터링
- 난이도/장르별 필터링

**3. 알림 설정 화면**

- 날짜 선택 (캘린더 UI)
- 시간대 선택 (체크박스)
- 인원 수 입력
- 알림 방식 토글

**4. 알림 히스토리**

- 발송된 알림 목록
- 클릭 시 예약 페이지 이동
- 알림 삭제/관리

### 디자인 가이드

- 반응형 웹 (모바일 우선)
- 다크/라이트 모드 지원
- 직관적인 아이콘 사용
- 빠른 로딩 속도

---

## ⚠️ 주의사항 및 고려사항

### 법적/윤리적 고려사항

- **robots.txt 준수**: 크롤링 전 각 사이트의 robots.txt 확인
- **과도한 요청 방지**: Rate limiting 적용하여 서버 부하 방지
- **개인정보 보호**: 사용자 데이터 암호화 및 안전한 저장
- **이용약관**: 각 방탈출 사이트의 크롤링 허용 여부 확인

### 기술적 고려사항

- **동적 웹페이지 대응**: JavaScript 렌더링 사이트를 위한 Headless Browser 사용
- **크롤링 차단 대응**: User-Agent 변경, IP 로테이션, CAPTCHA 우회 전략
- **에러 처리**: 크롤링 실패 시 재시도 로직 및 관리자 알림
- **성능 최적화**: 비동기 크롤링, 멀티스레딩, 캐싱 전략
- **확장성**: 새로운 사이트 추가 시 쉽게 확장 가능한 구조

### 서비스 제약사항

- 크롤링 대상 사이트의 구조 변경 시 크롤러 업데이트 필요
- 일부 사이트는 로그인 필요 시 제한적 정보만 제공
- 실시간성 보장 한계 (최소 1분 지연)

---

## 📈 개발 로드맵

### Phase 1: MVP (4주)

- [ ]  1개 사이트 크롤링 기능 구현
- [ ]  기본 회원가입/로그인
- [ ]  테마 알림 설정 (이메일만)
- [ ]  간단한 대시보드

### Phase 2: 핵심 기능 확장 (4주)

- [ ]  3-5개 주요 사이트 크롤링 추가
- [ ]  카카오톡/푸시 알림 추가
- [ ]  상세 조건 설정 (날짜, 시간대)
- [ ]  알림 히스토리 기능

### Phase 3: 고도화 (4주)

- [ ]  사이트 10개 이상 지원
- [ ]  테마 추천 기능
- [ ]  통계 및 분석 대시보드
- [ ]  모바일 앱 출시 검토

### Phase 4: 운영 및 최적화 (지속)

- [ ]  성능 모니터링 및 개선
- [ ]  사용자 피드백 반영
- [ ]  새로운 크롤링 사이트 추가
- [ ]  A/B 테스트 및 UX 개선

---

## 📊 성공 지표 (KPI)

### 사용자 지표

- DAU/MAU (일간/월간 활성 사용자)
- 사용자 등록 수
- 평균 등록 테마 수

### 서비스 지표

- 크롤링 성공률 (95% 이상 목표)
- 알림 발송 성공률
- 평균 알림 발송 시간 (빈 시간 발생 후)

### 비즈니스 지표

- 사용자 만족도 (설문조사)
- 실제 예약 전환율
- 서비스 재사용률

---

## 💰 수익 모델 (선택사항)

### 무료 서비스

- 기본 알림 기능
- 최대 3개 테마 추적
- 이메일 알림만

### 프리미엄 (유료)

- 무제한 테마 추적
- 우선 알림 (더 빠른 크롤링 주기)
- 카카오톡/SMS 알림
- 예약 성공률 통계
- 광고 제거

### 제휴 수익

- 방탈출 카페와 제휴
- 예약 수수료 또는 광고 수익

---

## 🔐 보안 요구사항

### 사용자 인증

- 이메일 인증 필수
- 비밀번호 암호화 (BCrypt)
- JWT 토큰 기반 인증

### 데이터 보안

- HTTPS 통신 필수
- 개인정보 암호화 저장
- 정기적인 보안 업데이트

### 크롤링 보안

- IP 차단 대응 전략
- Rate limiting
- 안전한 크롤링 환경 구축

---

## 📞 문의 및 지원

### 개발 관련

- 개발자 문서 작성
- API 문서화 (Swagger)
- GitHub Issues 관리

### 사용자 지원

- FAQ 페이지
- 1:1 문의 채널
- 공지사항 시스템

---

## 📱 화면 기획서

### 화면 구성

```
[로그인] → [메인 대시보드 - 내 알림 목록]
```

---

## 1️⃣ 메인 대시보드 - 내 알림 목록

### 화면 목적

사용자가 설정한 알림 예약 테마를 한눈에 확인

### 화면 레이아웃

```
┌─────────────────────────────────────┐
│  방탈출 예약 알림                       │
│  [로그아웃]                           │
├─────────────────────────────────────┤
│                                     │
│  📋 내가 예약한 알림 (3)                │
│                                     │
│  ┌─────────────────────────────┐    │
│  │ 🔔 활성                      │    │
│  │ 더 지니어스                    │   │
│  │ 넥스트에디션 강남점              │   │
│  │                             │   │
│  │ 📅 2025-12-01 ~ 2025-12-31  │   │
│  │ ⏰ 평일 저녁, 주말 오후          │   │
│  │ 👥 4명                       │   │
│  │                             │   │
│  │ [상세보기] [삭제]              │   │
│  └─────────────────────────────┘   │
│                                     │
│  ┌─────────────────────────────┐   │
│  │ 🔕 비활성                     │   │
│  │ 살인마의 방                    │   │
│  │ 비트포비아 홍대점                │   │
│  │                             │   │
│  │ 📅 2025-11-20 ~ 2025-11-30   │   │
│  │ ⏰ 주말 전체                   │   │
│  │ 👥 3명                        │   │
│  │                              │   │
│  │ [상세보기] [삭제]               │   │
│  └─────────────────────────────┘   │
│                                     │
│  ┌─────────────────────────────┐   │
│  │ 🔔 활성                       │   │
│  │ 타임리스: 메트로시티             │   │
│  │ 방방 신촌점                    │   │
│  │                             │   │
│  │ 📅 2025-12-15 ~ 2025-12-25  │   │
│  │ ⏰ 평일 오후                   │   │
│  │ 👥 2명                       │   │
│  │                             │   │
│  │ [상세보기] [삭제]              │   │
│  └─────────────────────────────┘   │
│                                     │
└─────────────────────────────────────┘

```

---

### 화면 구성 요소

**헤더**

- 서비스 타이틀: "방탈출 예약 알림"
- 로그아웃 버튼

**알림 카드 (반복)**

- 활성화 상태 표시
    - 🔔 활성 (is_active = true)
    - 🔕 비활성 (is_active = false)
- 테마명 (theme_name)
- 카페명 + 지점명 (cafe_name + branch_name)
- 예약 기간 (date_start ~ date_end)
- 선호 시간대 (preferred_times 요약)
- 인원 수 (num_people)
- 액션 버튼
    - [상세보기]: 알림 상세 정보 모달
    - [삭제]: 알림 삭제

---

### 데이터 조회 API

**Endpoint**: `GET /api/user-alerts`

**Response**:

```json
{
  "success": true,
  "data": [
    {
      "alertId": 1,
      "isActive": true,
      "theme": {
        "themeId": 101,
        "themeName": "더 지니어스",
        "cafeName": "넥스트에디션",
        "branchName": "강남점"
      },
      "dateStart": "2025-12-01",
      "dateEnd": "2025-12-31",
      "preferredTimes": ["18:00", "19:00", "20:00"],
      "preferredDays": ["MON", "TUE", "WED", "THU", "FRI"],
      "numPeople": 4,
      "notifiedCount": 3,
      "lastNotifiedAt": "2025-11-24T14:30:00"
    }
  ]
}

```

---

### 상태별 UI 처리

| 상태 | 배경색 | 텍스트 색상 | 아이콘 |
| --- | --- | --- | --- |
| 활성 | 연한 파란색 | 검정 | 🔔 |
| 비활성 | 연한 회색 | 회색 | 🔕 |

---

### 액션 처리

**1. 상세보기 클릭**

- 모달 팝업 또는 새 화면 이동
- 표시 정보:
    - 전체 설정 정보
    - 알림 발송 히스토리
    - 수정/삭제 옵션

**2. 삭제 클릭**

- 확인 다이얼로그: "정말 삭제하시겠습니까?"
- 확인 시: `DELETE /api/user-alerts/{alertId}` 호출
- 삭제 후 목록 새로고침

---

### 빈 상태 (Empty State)

알림이 없을 때:

```
┌─────────────────────────────────────┐
│                                     │
│         📭                          │
│                                     │
│   아직 설정된 알림이 없습니다         │
│                                     │
│   [+ 새 알림 추가하기]               │
│                                     │
└─────────────────────────────────────┘

```

---

### 반응형 대응

**데스크톱 (1024px+)**

- 카드 2열 배치
- 여백 충분

**태블릿 (768px ~ 1023px)**

- 카드 1열 배치
- 적당한 여백

**모바일 (~ 767px)**

- 카드 1열 배치
- 최소 여백
- 버튼 크기 확대 (터치 용이)

---

### 향후 확장 계획

- [ ]  알림 추가 화면
- [ ]  알림 수정 화면
- [ ]  알림 히스토리 화면
- [ ]  테마 검색/선택 화면
- [ ]  필터링/정렬 기능

---

## 📝 참고사항

### 크롤링 대상 예시

- 방방 (https://www.bangbang.zone)
- 프리즘 (https://www.prism.co.kr)
- 비트포비아
- 넥스트에디션
- 개별 방탈출 카페 자체 예약 시스템

### 유사 서비스 분석

- 항공권 가격 알림 서비스 (스카이스캐너)
- 식당 예약 알림 서비스
- 공연 티켓 알림 서비스

이들의 성공 전략을 벤치마킹하여 사용자 경험 개선에 활용합니다.

---

**문서 버전**: 1.0

**작성일**: 2025-11-25

**최종 수정일**: 2025-11-25
